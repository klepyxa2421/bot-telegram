# Інструкція по розгортанню Telegram Music Bot на Vercel

Цей документ містить детальні інструкції щодо розгортання вашого Telegram бота для скачування музики на платформі Vercel.

## Що таке Vercel?

[Vercel](https://vercel.com) - це хмарна платформа для статичних сайтів та Serverless функцій, яка дозволяє розгортати Node.js додатки безкоштовно. Вона має зручний інтерфейс, інтеграцію з Git і багато інших можливостей.

## Переваги використання Vercel для вашого бота:

1. Безкоштовний хостинг
2. Автоматичне масштабування
3. Глобальне CDN
4. Легке розгортання
5. Інтеграція з GitHub/GitLab/Bitbucket

## Основні файли для Vercel

У архіві, який ви отримали, є спеціально підготовлені файли для Vercel:

- `vercel.json` - конфігурація для Vercel
- `api/webhook.js` - Serverless функція, яка обробляє запити від Telegram

## Кроки для розгортання:

### 1. Створіть обліковий запис на Vercel

Якщо у вас ще немає облікового запису, зареєструйтесь на [Vercel](https://vercel.com).

### 2. Створіть репозиторій на GitHub/GitLab/Bitbucket

1. Розпакуйте архів `telegram_music_bot_vercel.tar.gz`
2. Ініціалізуйте Git репозиторій і завантажте код:

```bash
# Розпакуйте архів
tar -xzvf telegram_music_bot_vercel.tar.gz -C my-telegram-bot
cd my-telegram-bot

# Ініціалізуйте Git репозиторій
git init
git add .
git commit -m "Initial commit"

# Створіть репозиторій на GitHub і завантажте код
git remote add origin https://github.com/your-username/my-telegram-bot.git
git push -u origin main
```

### 3. Імпортуйте проект у Vercel

1. Увійдіть у свій обліковий запис Vercel
2. Натисніть "Add New..." > "Project"
3. Виберіть свій репозиторій
4. Перейдіть до налаштувань змінних середовища

### 4. Налаштуйте змінні середовища

Додайте наступні змінні середовища:

- `TELEGRAM_TOKEN` - Ваш токен Telegram бота (отриманий від @BotFather)
- `SPOTIFY_CLIENT_ID` - Ваш Spotify Client ID (необов'язково)
- `SPOTIFY_CLIENT_SECRET` - Ваш Spotify Client Secret (необов'язково)

### 5. Розгорніть проект

Натисніть "Deploy" і дочекайтеся завершення розгортання.

### 6. Налаштуйте webhook для Telegram бота

Після успішного розгортання, ви отримаєте URL вашого проекту (наприклад, `https://my-telegram-bot.vercel.app`).

Тепер вам потрібно налаштувати Telegram webhook, щоб направляти оновлення до вашої Vercel функції. Замініть `YOUR_BOT_TOKEN` і `YOUR_VERCEL_URL` на ваші реальні значення:

```
https://api.telegram.org/botYOUR_BOT_TOKEN/setWebhook?url=YOUR_VERCEL_URL/api/webhook
```

Наприклад:
```
https://api.telegram.org/bot123456789:ABCDEF/setWebhook?url=https://my-telegram-bot.vercel.app/api/webhook
```

Ви можете виконати цей запит у браузері або за допомогою curl:

```bash
curl "https://api.telegram.org/botYOUR_BOT_TOKEN/setWebhook?url=YOUR_VERCEL_URL/api/webhook"
```

### 7. Перевірте роботу бота

Відкрийте Telegram, знайдіть свого бота і відправте йому команду `/start`. Якщо бот відповідає, значить все налаштовано правильно!

## Особливості та обмеження Vercel

### Обмеження безкоштовного плану:

1. **Файлова система**: Vercel має тимчасову файлову систему. Це означає, що файли, завантажені під час виконання функції, не зберігаються між запитами. Для великих музичних файлів це може бути проблемою. Рішення:
   
   - Використовуйте зовнішні сховища, такі як AWS S3, Google Cloud Storage тощо.
   - Оптимізуйте процес завантаження, щоб не зберігати великі файли на сервері.

2. **Час виконання**: Функції мають ліміт часу виконання (10 секунд на безкоштовному плані). Якщо завантаження музики займає більше часу, це може призвести до помилок.

3. **Розмір відповіді**: Максимальний розмір відповіді - 4.5 МБ. Це може бути недостатньо для деяких аудіофайлів.

## Моніторинг і підтримка

1. **Логи**: На Vercel ви можете переглядати логи ваших функцій через їх інтерфейс.

2. **Uptime моніторинг**: Рекомендується використовувати зовнішні сервіси моніторингу, такі як UptimeRobot, щоб підтримувати функцію активною.

## Додаткові налаштування

### Підтримка зовнішнього сховища

Якщо ви хочете використовувати зовнішні сховища для файлів, вам потрібно додати відповідні змінні середовища та модифікувати код. Наприклад, для AWS S3:

1. Встановіть aws-sdk:
```bash
npm install aws-sdk
```

2. Додайте змінні середовища:
```
AWS_ACCESS_KEY_ID=your_access_key
AWS_SECRET_ACCESS_KEY=your_secret_key
AWS_REGION=your_region
AWS_S3_BUCKET=your_bucket_name
```

3. Модифікуйте код для завантаження файлів в S3 замість локальної файлової системи.

## Альтернативи Vercel

Якщо ви стикаєтеся з обмеженнями Vercel, розгляньте інші платформи:

1. **Heroku** - має безкоштовний план, але з обмеженнями
2. **Railway** - подібний до Vercel, але з іншими лімітами
3. **Digital Ocean** - платний, але з більшою гнучкістю
4. **AWS Lambda** - безкоштовний рівень з власними обмеженнями

## Висновок

Vercel - це відмінне рішення для розгортання Telegram бота, особливо якщо ваш бот не потребує тривалих операцій або великих файлів. Використовуйте ці інструкції для швидкого розгортання і налаштування вашого бота.